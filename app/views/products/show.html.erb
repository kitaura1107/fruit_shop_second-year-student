<h1>商品詳細</h1>

<div>
  <% if @product.photo.attached? %>
    <%= image_tag @product.thumbnail %>
  <% end %>
  <p>商品名: <%= @product.name %></p>
  <p>説明: <%= @product.description %></p>
  <p>価格: <%= @product.price %>円</p>
  
  <% if current_user&.admin_flg %>
      <%= link_to "編集", edit_product_path(@product) %>
      <%= link_to '削除', product_path(@product),  data: { turbo_method: :delete, turbo_confirm: '本当に削除しますか？' } %>
    <% elsif !current_user %>
      <%= form_with url: add_product_carts_path, local: true, data: { turbo: false } do |form| %>
      <%= form.hidden_field :product_id, value: @product.id %>
      <%= form.number_field :count, value: 1, min: 1 %>
      <%= form.submit 'カートに追加' %>
    <% end %>
     
    <% else %>

    <%= form_with scope: :cart_item, url: cart_items_path do |form| %>
      <%= form.hidden_field :product_id, value: @product.id %>
      <%= form.number_field :quantity, value: 1, min: 1 %>
      <%= form.submit "カートに追加" %>
    <% end %>

  <% end %>
</div>